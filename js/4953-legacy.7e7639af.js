"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[4953],{54953:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{Z:function(){return WebOffice2015}});var core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(41539),core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_es_object_to_string_js__WEBPACK_IMPORTED_MODULE_0__),core_js_modules_es_regexp_to_string_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(39714),core_js_modules_es_regexp_to_string_js__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(core_js_modules_es_regexp_to_string_js__WEBPACK_IMPORTED_MODULE_1__),core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(74916),core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(core_js_modules_es_regexp_exec_js__WEBPACK_IMPORTED_MODULE_2__),core_js_modules_es_string_split_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(23123),core_js_modules_es_string_split_js__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(core_js_modules_es_string_split_js__WEBPACK_IMPORTED_MODULE_3__),core_js_modules_es_symbol_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(82526),core_js_modules_es_symbol_js__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(core_js_modules_es_symbol_js__WEBPACK_IMPORTED_MODULE_4__),core_js_modules_es_symbol_description_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(41817),core_js_modules_es_symbol_description_js__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(core_js_modules_es_symbol_description_js__WEBPACK_IMPORTED_MODULE_5__);function WebOffice2015(){var ISO,root,rootValue,MenuFile;this.dVersion="4.8.7.26",this.dUpdateDate="2018-7-26",this.PASSWORD="123456",this.Ashell=null,this.BookMark="",this.ImageName="",this.obj,this.DownloadedFileTempPathName="",this.DOWN="\\WebOffice\\Down\\",this.UP="\\WebOffice\\UP\\",this.FilePath=null,this.TmpFile=null,this.tempInsertName="",this.DocTypeValue={DOC:0,DOCX:16,XLS:56,XLSX:51,WPS:0},this.DocSuffixType={0:".doc",12:".docx",56:".xls",51:".xlsx"},this.setVersion=-1,this.OfficeVersion={v2003:1,vOther:0},this.sendMode=null,this.iWebOfficeTempName="iWebOfficeTempName.doc",this.WebUrl="",this.RecordID="",this.Template="",this.FileName="",this.UserName="",this.OfficeUserName="",this.FileType="",this.EditType="",this.ExtParam="",this.PenColor="#FF0000",this.PenWidth="3",this.Print="1",this.WebObject=null,this.ShowToolBar=1,this.ShowType="1",this.Modify=!1,this.CopyType="1",this.ShowMenu="1",this.Language="CH",this.Status="",this.WindowStatus="1",this.ToolsSpace=1,this.MaxFileSize=8192,this.ShowWindow=!0,this.Office2007Ribbon=0,this.RibbonUIXML="",this.ChangeSize=!1,this.ShortCutKey="",this.AllowEmpty=!0,this.UIControl=!1,this.Compatible=!1,this.ShowStatus=!1,this.ClearTempFileByDays=7,this.ChangeWindowSize=!0,this.LocalTempPath="",this.OpenFileType="",this.DebugMode=!1,this.HiddenDirectory=!1,this.DelFileAfterSave=!0,this.SetCaption=function(t){this.obj.Caption=t},this.WebOpen=function(t){this.ConsoleOut("<WebOpen> 开始..."),this.Status="";var e=this.obj.Http;return e.Clear(),this.WebSetMsgByName("USERNAME",this.UserName),this.WebSetMsgByName("FILENAME",this.FileName),this.WebSetMsgByName("FILETYPE",this.FileType),this.WebSetMsgByName("RECORDID",this.RecordID),this.WebSetMsgByName("EDITTYPE",this.EditType),this.WebSetMsgByName("OPTION","LOADFILE"),e.AddForm("FormData",this.GetMessageString()),this.WebClearMessage(),this.sendMode="OpenFile",this.ConsoleOut("<WebOpen> 开始下载文档..."),this.NewShowMenu(this.ShowMenu),this.NewShowToolBar(this.ShowToolBar),!!this.LOADFILE(e)&&(this.NewCopyType(this.CopyType),this.NewUIControl(this.UIControl),this.ConsoleOut("<WebOpen> 成功..."),(e=this.obj.Http).GetResponseHeader("ISO"),".ppt"!=this.FileType&&".pptx"!=this.FileType&&this.VBASetUserName(this.UserName),this.setEditType(this.EditType),this.Status="打开文档成功",!0)},this.WebSave=function(){this.ConsoleOut("<WebSave> 开始..."),this.Status="";var t=this.obj.Http;if(t.Clear(),this.WebSetMsgByName("USERNAME",this.UserName),this.WebSetMsgByName("RECORDID",this.RecordID),this.WebSetMsgByName("TEMPLATE",this.Template),this.WebSetMsgByName("SUBJECT",this.Subject),this.WebSetMsgByName("AUTHOR",this.Author),this.WebSetMsgByName("HTMLPATH",this.HTMLPath),this.WebSetMsgByName("FILETYPE",this.FileType),this.WebSetMsgByName("OPTION","SAVEFILE"),this.WebSetMsgByName("FILENAME",this.FileName),this.ConsoleOut("<WebSave> 开始将文档保存到本地..."),this.WebSetAllowEmpty()){var e=this.WebSaveLocalFile(this.getFilePath()+this.FileName);if(0!=e)return this.ConsoleOut("<WebSave> 保存本地文档失败！错误代码为："+e),this.Status="保存本地文档失败！错误代码为："+e,!1}else alert("文档没有内容，是否确定保存");return this.ConsoleOut("<WebSave> 将文档保存到本地成功..."),this.sendMode="SaveFile",this.ConsoleOut("<WebSave> 开始将文档保存到服务器..."),this.WebSetMaxFileSize(this.FilePath+this.FileName)?!!this.SAVEFILE(t,this.FilePath+this.FileName)&&(this.ConsoleOut("<WebSave> 成功将文档保存到服务器..."),t.GetResponseHeader("ISO"),this.Status="成功将文档保存到服务器",!0):(this.Status="保存失败：MaxFileSize只能允许保存：<"+this.MaxFileSize/1024+">M",!1)},this.WebClose=function(){return!!this.Close()},this.WebSetMsgByName=function(t,e){this.ht.Add(t,e)},this.WebGetMsgByName=function(t){return this.ht.Get(t)},this.WebSendMessage=function(){this.ConsoleOut("<SendMessage> 开始...");var t=this.obj.Http;return t.Clear(),this.WebSetMsgByName("OPTION","SENDMESSAGE"),this.sendMode="SendMessage",t.ShowProgressUI=this.ShowWindow,t.AddForm("FormData",this.GetMessageString()),this.ConsoleOut("<SendMessage> 开始发到服务器..."),t.Open(this.HttpMethod.Post,this.WebUrl,!1)?t.Send()?(this.ConsoleOut("<SendMessage> 开始获取服务器上的数据"),this.GetDataToSend(),this.ConsoleOut("<SendMessage> 获取成功，发送到前台"),t.Clear(),this.Status=this.WebGetMsgByName("STATUS"),!0):(this.ConsoleOut("<SendMessage> 数据包发送失败"),this.Status=this.WebGetMsgByName("STATUS"),!1):(this.ConsoleOut("<SendMessage> 网络通信异常..."),!(this.Status="网络通信异常"))},this.WebClearMessage=function(){this.ht.Clear()},this.WebSavePDF=function(){this.ConsoleOut("<WebSavePDF> 开始...");var t=this.obj.Http;return t.Clear(),this.WebSetMsgByName("RECORDID",this.RecordID),this.WebSetMsgByName("OPTION","SAVEPDF"),this.WebSetMsgByName("FILENAME",this.RecordID+".pdf"),this.ConsoleOut("<WebSavePDF> 开始保存PDF到本地..."),this.SaveAsPdf(this.getFilePath()+this.RecordID+".pdf"),this.ConsoleOut("<WebSavePDF> 开始保存PDF到服务器..."),this.SAVEFILE(t,this.getFilePath()+this.RecordID+".pdf")?(this.ConsoleOut("<WebSavePDF> 保存保存PDF到服务器..."),this.Status="保存PDF文件成功",!0):(this.ConsoleOut("<WebSavePDF> 保存PDF失败..."),!(this.Status="保存PDF文件失败"))},this.WebSaveAsHtml=function(){if(this.ConsoleOut("<WebSaveAsHtml> 开始..."),this.SaveAsHtml(this.getFilePath()+this.RecordID+".html")){this.ConsoleOut("<WebSaveAsHtml> Html保存到本地成功...");var t=this.getFilePath()+this.RecordID+".files",e=this.obj.FileSystem.FindToDirAsFileEx(t).split("\r\n"),i=this.obj.Http;i.Clear(),this.WebSetMsgByName("RECORDID",this.RecordID),this.WebSetMsgByName("OPTION","SAVEHTML"),this.WebSetMsgByName("DIRECTORY",this.RecordID+".files"),this.ConsoleOut("<WebSaveAsHtml> 循环保存files文件夹内容...");for(var s=0;s<e.length;s++){var o=e[s];if(this.WebSetMsgByName("FILENAME",o),!this.SAVEFILE(i,t+"\\"+o))return!(this.Status="保存HTML文件失败")}return this.WebSetMsgByName("DIRECTORY",""),this.WebSetMsgByName("FILENAME",this.RecordID+".html"),this.ConsoleOut("<WebSaveAsHtml> files文件夹内容成功,开始保存Html文件夹内容..."),this.SAVEFILE(i,this.getFilePath()+this.RecordID+".html")?(this.ConsoleOut("<WebSaveAsHtml> 保存Html文件夹内容成功..."),this.Status="保存HTML文件成功",!0):!(this.Status="保存HTML文件失败")}return this.ConsoleOut("<WebSaveAsHtml> 保存Html文件夹内容失败..."),this.Status="保存HTML文件失败!",this.ConsoleOut("<WebSaveAsHtml> 结束..."),!1},this.WebUpdateFile=function(){return!(this.Status="该功能暂未提供!")},this.WebSaveVersion=function(){return!(this.Status="该功能暂未提供!")},this.WebSaveVersionByFileID=function(){return!(this.Status="该功能暂未提供!")},this.WebOpenVersion=function(){return!(this.Status="该功能暂未提供!")},this.WebSaveTemplate=function(){this.ConsoleOut("<WebSaveTemplate> 开始..."),this.Status="";var t=this.obj.Http,e=(t.Clear(),this.WebSetMsgByName("OPTION","SAVETEMPLATE"),this.WebSetMsgByName("TEMPLATE",this.Template),this.ConsoleOut("<WebSaveTemplate> 开始将文档保存到本地..."),this.WebSaveLocalFile(this.getFilePath()+this.FileName));return 0!=e?(this.ConsoleOut("<WebSaveTemplate> 保存本地文档失败！错误代码为："+e),this.Status="保存本地文档失败！错误代码为："+e,!1):(this.ConsoleOut("<WebSaveTemplate> 将文档保存到本地成功..."),this.sendMode="WebSaveTemplate",this.ConsoleOut("<WebSaveTemplate> 开始将文档保存到服务器..."),!!this.SAVEFILE(t,this.FilePath+this.FileName)&&(this.ConsoleOut("<WebSaveTemplate> 成功将文档保存到服务器..."),this.Status="保存模板文件成功",!0))},this.WebLoadTemplate=function(){this.ConsoleOut("<WebLoadTemplate> 开始...");var t=this.obj.Http,e=(this.ClearRevisions(),this.WebSetMsgByName("OPTION","LOADTEMPLATE"),this.WebSetMsgByName("TEMPLATE",this.Template),t.AddForm("FormData",this.GetMessageString()),this.WebClearMessage(),this.ConsoleOut("<WebLoadTemplate> 将当前文档保存到本地..."),this.WebSaveLocalFile(this.getFilePath()+this.iWebOfficeTempName));return 0!=e?(this.ConsoleOut("<WebLoadTemplate> 保存本地文档失败！错误代码为："+e),this.Status="保存本地文档失败！错误代码为："+e,this.ConsoleOut("<WebLoadTemplate> 结束..."),!1):(this.ConsoleOut("<WebLoadTemplate> 开始打开套红文档..."),this.LOADFILE(t)?(this.ConsoleOut("<WebLoadTemplate> 打开套红文档成功..."),this.ConsoleOut("<WebLoadTemplate> 开始插入正文..."),this.VBAInsertFile("Content",this.getFilePath()+this.iWebOfficeTempName)?(this.ConsoleOut("<WebLoadTemplate> 插入正文成功..."),this.Status="套红成功",this.ConsoleOut("<WebLoadTemplate> 结束..."),!0):(this.ConsoleOut("<WebLoadTemplate> 插入正文失败..."),!1)):(this.ConsoleOut("<WebLoadTemplate> 打开套红文档失败..."),this.Status="打开文档失败",this.ConsoleOut("<WebLoadTemplate> 结束..."),!1))},this.WebSaveImage=function(t,e){if(this.ConsoleOut("<WebSaveAsHtml> 开始..."),".doc"!=this.FileType&&".docx"!=this.FileType&&".wps"!=this.FileType)return this.ConsoleOut("<WebSaveImage> 保存Html文件夹内容失败..."),this.Status="保存HTML图片文件失败!",this.ConsoleOut("<WebSaveImage> 结束..."),!1;this.ConsoleOut("<WebSaveImage> Html保存到本地...");var i=this.getFilePath()+this.RecordID+".htm",s=this.getFilePath()+this.RecordID+".files",o=(this.obj.ActiveDocument.SaveAs(i,10,!1,"",!1,"",!1,!1,!1,!1,!1,0),this.obj.ActiveDocument.Application.ActiveWindow.View.type=3,this.ConsoleOut("<WebSaveImage> Html保存到本地成功..."),new VBArray(this.obj.FileSystem.FindToDirAsFile(s)).toArray()),n=this.obj.Http;n.Clear(),this.WebSetMsgByName("RECORDID",this.RecordID),this.WebSetMsgByName("OPTION","SAVEIMAGE"),this.WebSetMsgByName("DIRECTORY",this.RecordID+".files"),this.ConsoleOut("<WebSaveImage> 循环保存files文件夹内容...");for(var h=0;h<o.length;h++){var a=o[h];if(this.WebSetMsgByName("FILENAME",a),!this.SAVEFILE(n,s+"\\"+a))return!(this.Status="保存HTML图片文件失败")}return this.WebSetMsgByName("DIRECTORY",""),this.WebSetMsgByName("FILENAME",this.RecordID+".htm"),this.ConsoleOut("<WebSaveImage> files文件夹内容成功,开始保存Html文件夹内容..."),this.SAVEFILE(n,this.getFilePath()+this.RecordID+".htm")?(this.ConsoleOut("<WebSaveImage> 保存Html文件夹内容成功..."),this.Status="保存HTML图片文件成功",!0):!(this.Status="保存HTML图片文件失败")},this.WebInsertFile=function(){var t=this.obj.Http,e=(this.ConsoleOut("<WebInsertFile> 开始..."),this.WebSetMsgByName("TEMPLATE",this.Template),this.WebSetMsgByName("OPTION","INSERTFILE"),t.AddForm("FormData",this.GetMessageString()),this.WebClearMessage(),this.WebUrl.substring(0,this.WebUrl.lastIndexOf("/")));return t.ShowProgressUI=this.ShowWindow,this.ConsoleOut("<WebInsertFile> 开始打开连接..."),t.Open(this.HttpMethod.Post,e+"/Document/"+this.Template,!1)?t.Send()?(this.ConsoleOut("<WebInsertFile> 数据包发送成功..."),this.ConsoleOut("<WebInsertFile> 判断接收数据是否异常..."),200==t.Status?(this.ConsoleOut("<WebInsertFile> 开始将后台文件保存到本地..."),this.hiddenSaveLocal(t,this,!1,!1,this.Template)?(this.ConsoleOut("<WebInsertFile> 后台文件保存到本地成功..."),this.ConsoleOut("<WebInsertFile> 插入书签正文..."),this.obj.ActiveDocument.BookMarks.Exists(this.BookMark)?this.VBAInsertFile(this.BookMark,this.DownloadedFileTempPathName)?(this.ConsoleOut("<WebInsertFile> 插入正文成功..."),this.Status="插入成功",t.Clear(),this.ConsoleOut("<WebInsertFile> 结束..."),!0):(this.ConsoleOut("<WebInsertFile> 插入正文失败..."),this.ConsoleOut("<WebInsertFile> 结束..."),!1):(this.ConsoleOut("<WebInsertFile> 文档里没有对应书签..."),this.Status="文档里没有对应书签",this.ConsoleOut("<WebInsertFile> 结束..."),!1)):(this.ConsoleOut("<WebInsertFile> 文档保存到本地失败..."),this.Status="文档保存到本地失败",this.ConsoleOut("<WebInsertFile> 结束..."),!1)):(this.ConsoleOut("<WebInsertFile> 数据接收误..."),this.Status="数据接收错误",this.ConsoleOut("<WebInsertFile> 结束..."),!1)):(this.ConsoleOut("<WebInsertFile> 数据包发送失败..."),this.Status="数据包发送失败",this.ConsoleOut("<WebInsertFile> 结束..."),!1):(this.ConsoleOut("<WebInsertFile> 打开连接失败..."),this.Status="打开连接失败",this.ConsoleOut("<WebInsertFile> 结束..."),!1)},this.WebInsertImage=function(t,e,i,s){var o;return this.ConsoleOut("<WebInsertImage> 开始..."),".doc"==this.FileType||".docx"==this.FileType?"-1"==this.obj.ActiveDocument.ProtectionType?(o=this.obj.Http,this.BookMark=t,this.ImageName=e,this.WebSetMsgByName("OPTION","INSERTIMAGE"),this.WebSetMsgByName("IMAGENAME",this.ImageName),o.AddForm("FormData",this.GetMessageString()),this.WebClearMessage(),o.ShowProgressUI=this.ShowWindow,this.ConsoleOut("<WebInsertImage> 开始打开连接..."),o.Open(this.HttpMethod.Post,this.WebUrl,!1)?(this.ConsoleOut("<WebInsertImage> 开始向后台发送数据包..."),o.Send()?(this.ConsoleOut("<WebInsertImage> 数据包发送成功..."),this.ConsoleOut("<WebInsertImage> 判断接收数据是否异常..."),200==o.Status?(this.ConsoleOut("<WebInsertImage> 开始将后台文件保存到本地..."),this.hiddenSaveLocal(o,this,!1,!1,this.ImageName)?(this.ConsoleOut("<WebInsertImage> 后台文件保存到本地成功..."),this.ConsoleOut("<WebInsertImage> 运行书签插入图片..."),this.InsertImageByBookMark(i,s)?(this.ConsoleOut("<WebInsertImage> 本地内容加载到控件成功..."),this.ImageName=null,this.BookMark=null,o.Clear(),this.Status="插入服务器图片成功",!0):(this.ConsoleOut("<WebInsertImage> 书签插入图片失败..."),this.Status="书签插入图片失败",this.ConsoleOut("<WebInsertImage> 结束..."),!1)):(this.ConsoleOut("<WebInsertImage> 文档保存到本地失败..."),this.Status="文档保存到本地失败",this.ConsoleOut("<WebInsertImage> 结束..."),!1)):(this.ConsoleOut("<WebInsertImage> 数据接收误..."),this.Status="数据接收错误",this.ConsoleOut("<WebInsertImage> 结束..."),!1)):(this.ConsoleOut("<WebInsertImage> 发送数据包失败..."),this.Status="发送数据包失败",this.ConsoleOut("<WebInsertImage> 结束..."),!1)):(this.ConsoleOut("<WebInsertImage> 打开连接失败..."),this.Status="打开连接失败",this.ConsoleOut("<WebInsertImage> 结束..."),!1)):!(this.Status="文档锁定，插入失败"):!(this.Status="非Word文档，插入失败")},this.WebSaveBookMarks=function(){this.ConsoleOut("<WebSaveBookMarks> 开始...");for(var t=this.obj.Http,e=(t.Clear(),this.obj.ActiveDocument.Bookmarks.Count),i=1;i<=e;i++){var s=this.obj.ActiveDocument.Bookmarks.Item(i).Name,o=this.obj.ActiveDocument.Bookmarks.Item(s).Range.text;this.WebSetMsgByName(s,o)}return this.WebSetMsgByName("OPTION","SAVEBOOKMARKS"),this.WebSetMsgByName("TEMPLATE",this.RecordID),t.AddForm("FormData",this.GetMessageString()),this.WebClearMessage(),t.ShowProgressUI=this.ShowWindow,this.ConsoleOut("<WebSaveBookMarks> 开始打开连接..."),t.Open(this.HttpMethod.Post,this.WebUrl,!1)?(this.ConsoleOut("<WebSaveBookMarks> 开始向后台发送数据包..."),t.Send()?(this.ConsoleOut("<WebSaveBookMarks> 数据包发送成功..."),this.Status="书签保存成功",this.ConsoleOut("<WebSaveBookMarks> 结束..."),t.Clear(),!0):(this.ConsoleOut("<WebSaveBookMarks> 数据包发送失败..."),this.Status="数据包发送失败",this.ConsoleOut("<WebSaveBookMarks> 结束..."),t.Clear(),!1)):(this.ConsoleOut("<WebSaveBookMarks> 打开连接失败..."),this.Status="打开连接失败",this.ConsoleOut("<WebSaveBookMarks> 结束..."),t.Clear(),!1)},this.WebOpenBookMarks=function(){return".doc"==this.FileType||".docx"==this.FileType?"-1"==this.obj.ActiveDocument.ProtectionType?(this.obj.ActiveDocument.Application.Dialogs.Item(168).Show(),!0):!(this.Status="文档被锁定，操作失败"):!(this.Status="非Word文档，操作失败")},this.WebLoadBookMarks=function(){this.ConsoleOut("<WebLoadBookMarks> 开始...");var httpclient=this.obj.Http;if(httpclient.Clear(),this.WebSetMsgByName("RECORDID",this.RecordID),this.WebSetMsgByName("TEMPLATE",this.Template),this.WebSetMsgByName("FILENAME",this.FileName),this.WebSetMsgByName("FILETYPE",this.FileType),this.WebSetMsgByName("OPTION","LOADBOOKMARKS"),httpclient.AddForm("FormData",this.GetMessageString()),this.WebClearMessage(),this.sendMode="WebLoadBookMarks",httpclient.ShowProgressUI=this.ShowWindow,this.ConsoleOut("<WebLoadBookMarks> 开始打开连接..."),httpclient.Open(this.HttpMethod.Post,this.WebUrl,!1)){if(this.ConsoleOut("<WebLoadBookMarks> 开始向后台发送数据包..."),httpclient.Send()){this.ConsoleOut("<WebLoadBookMarks> 获取书签内容插入到书签...");var ReturnValue=httpclient.GetResponseHeader("RName"),jsonObj=eval("("+ReturnValue+")");try{for(var i in jsonObj){var BookName=i,BookValue=jsonObj[i];if(!this.obj.ActiveDocument.BookMarks.Exists(BookName))return this.ConsoleOut("<WebLoadBookMarks> 没有找到"+BookName+"书签..."),this.Status="没有找到"+BookName+"书签",!1;var mBookRange=this.obj.ActiveDocument.Bookmarks.Item(BookName).Range;mBookRange.text=BookValue}}catch(e){return this.ConsoleOut("<WebLoadBookMarks> 插入书签出现异常"+e.description),this.Status=e.description,!1}return this.ConsoleOut("<WebLoadBookMarks> 书签内容已插入到书签..."),this.Status="书签内容已插入到书签",!0}return this.ConsoleOut("<WebLoadBookMarks> 向后台发送数据包错误..."),this.Status="向后台发送数据包错误",!1}return this.ConsoleOut("<WebLoadBookMarks> 打开链接错误..."),this.Status="打开链接错误",!1},this.WebOpenSignature=function(){return!(this.Status="该功能暂未提供!")},this.WebCheckSignature=function(){return!(this.Status="该功能暂未提供!")},this.WebShowSignature=function(){return!(this.Status="该功能暂未提供!")},this.WebGetFile=function(t,e){this.ConsoleOut("<WebGetFile> 开始...");var i=this.obj.Http;if(i.Clear(),this.WebSetMsgByName("RECORDID",this.RecordID),this.WebSetMsgByName("LOCALFILE",t),this.WebSetMsgByName("REMOTEFILE",e),this.WebSetMsgByName("OPTION","GETFILE"),i.AddForm("FormData",this.GetMessageString()),this.WebClearMessage(),i.ShowProgressUI=!0,this.ConsoleOut("<WebGetFile> 开始打开链接..."),i.Open(this.HttpMethod.Post,this.WebUrl,!1)){if(this.ConsoleOut("<WebGetFile> 开始向后台发送数据包..."),i.Send()){if(this.ConsoleOut("<WebGetFile> 数据包发送成功..."),"404"==i.GetResponseHeader("MsgError"))return this.ConsoleOut("<WebGetFile> 后台未找到对应文档"),this.Status="后台未找到对应文档",i.Clear(),this.ConsoleOut("<WebGetFile> 结束..."),!1;i.Clear();this.obj.FileSystem;return this.ConsoleOut("<WebGetFile> 创建本地路径"),this.ConsoleOut("<WebGetFile> 文档下载到本地"),i.ResponseSaveToFile(t),this.ConsoleOut("<WebGetFile> 文档下载成功"),this.Status="文档下载到本地成功",i.Clear(),this.ConsoleOut("<WebGetFile> 结束..."),!0}return this.ConsoleOut("<WebGetFile> 数据包发送失败..."),this.Status="数据包发送失败",this.ConsoleOut("<WebGetFile> 结束..."),!1}return this.ConsoleOut("<WebGetFile> 打开连接失败..."),this.Status="打开连接失败",i.Clear(),this.ConsoleOut("<WebGetFile> 结束..."),!1},this.WebPutFile=function(t,e){this.ConsoleOut("<WebPutFile> 开始...");var i=this.obj.Http;return i.Clear(),this.WebSetMsgByName("REMOTEFILE",e),this.WebSetMsgByName("OPTION","PUTFILE"),i.AddForm("FormData",this.GetMessageString()),i.AddFile("FileData",t),this.WebClearMessage(),i.ShowProgressUI=!1,this.ConsoleOut("<WebPutFile> 开始打开链接..."),i.Open(this.HttpMethod.Post,this.WebUrl,!1)?(this.ConsoleOut("<WebPutFile> 开始向后台发送数据包..."),i.Send()?(this.ConsoleOut("<WebPutFile> 文档上传成功..."),this.Status="文档上传成功",i.Clear(),this.ConsoleOut("<WebPutFile> 结束..."),!0):(this.ConsoleOut("<WebPutFile> 数据包发送失败..."),this.Status="文档上传失败",i.Clear(),this.ConsoleOut("<WebPutFile> 结束..."),!1)):(this.ConsoleOut("<WebPutFile> 打开链接失败..."),this.Status="打开链接失败",i.Clear(),this.ConsoleOut("<WebGetFile> 结束..."),!1)},this.WebDelFile=function(t,e){var i;return this.ConsoleOut("<WebDelFile> 开始..."),""==t?""!=e?(this.ConsoleOut("<WebDelFile> 开始删除远程文档..."),(i=this.obj.Http).Clear(),this.WebSetMsgByName("REMOTEFILE",e),this.WebSetMsgByName("OPTION","DELFILE"),i.AddForm("FormData",this.GetMessageString()),this.WebClearMessage(),i.ShowProgressUI=!1,this.ConsoleOut("<WebDelFile> 开始打开链接..."),i.Open(this.HttpMethod.Post,this.WebUrl,!1)?(this.ConsoleOut("<WebDelFile> 连接成功，开始向后台发送数据包..."),i.Send()?(this.ConsoleOut("<WebDelFile> 连接数据包成功..."),"成功"==this.WebGetMsgByName("DelFileState")?(this.ConsoleOut("<WebDelFile> 文档删除成功..."),this.Status="文档删除成功",i.Clear(),this.ConsoleOut("<WebDelFile> 结束..."),!0):(this.ConsoleOut("<WebDelFile> 文档不存在..."),this.Status="文档不存在",i.Clear(),this.ConsoleOut("<WebDelFile> 结束..."),!1)):(this.ConsoleOut("<WebDelFile> 向后台发送数据包失败..."),this.Status="向后台发送数据包失败",i.Clear(),this.ConsoleOut("<WebDelFile> 结束..."),!1)):(this.ConsoleOut("<WebDelFile> 打开链接失败..."),this.Status="打开链接失败",this.ConsoleOut("<WebDelFile> 结束..."),!1)):(this.ConsoleOut("<WebDelFile> 文件名为空，请输入要删除的文件名..."),this.Status="文件名为空，请输入要删除的文件名",this.ConsoleOut("<WebDelFile> 结束..."),!1):(e=this.obj.FileSystem,this.ConsoleOut("<WebDelFile> 删除本地文档..."),e.DeleteFile(t)?(this.ConsoleOut("<WebDelFile> 删除本地文档成功..."),this.Status="删除本地文件成功",this.ConsoleOut("<WebDelFile> 结束..."),!0):(this.ConsoleOut("<WebDelFile> 该文档不存在或者没有权限删除..."),this.Status="该文档不存在或者没有权限删除",this.ConsoleOut("<WebDelFile> 结束..."),!1))},this.WebDateTime=function(t){return!(this.Status="该功能暂未提供!")},this.CreateFile=function(){switch(this.getDocType(this.FileType)){case this.DocType.WORD:this.obj.CreateNew("Word.Document"),this.Status="新建WORD成功";break;case this.DocType.EXECL:this.obj.CreateNew("Excel.Sheet"),this.Status="新建EXECL成功";break;case this.DocType.PICTURE:this.obj.CreateNew("iWebPicture.iWebPictureMain"),this.Status="新建TIF成功";break;case this.DocType.PPT:this.obj.CreateNew("PowerPoint.Show"),this.Status="新建PPT成功";break;default:this.obj.CreateNew("Word.Document"),this.Status="新建WORD成功"}},this.FullSize=function(t){this.obj.FullSize=t},this.WebSaveLocal=function(){this.ConsoleOut("<WebSaveLocal> 开始..."),this.setShowDialog(this.ShowDialog.DialogSaveCopyAs),this.ConsoleOut("<WebSaveLocal> 文档保存到本地成功..."),this.Status="文档保存到本地成功"},this.WebOpenLocal=function(){this.ConsoleOut("<WebOpenLocal> 开始..."),this.setShowDialog(this.ShowDialog.DialogOpen,this.getOpenDocSuffix(this.FileType)),this.ConsoleOut("<WebOpenLocal> 打开本地文件成功..."),this.Status="打开本地文档成功"},this.WebSaveLocalDialog=function(){return!(this.Status="该功能暂未提供!")},this.WebOpenLocalDialog=function(){return!(this.Status="该功能暂未提供!")},this.WebSaveLocalFile=function(t){this.ConsoleOut("<WebSaveLocalFile> 开始...");try{return this.ConsoleOut("<WebSaveLocalFile> 开始删除之前的文件..."),this.WebDelLocalFile(t),this.ConsoleOut("<WebSaveLocalFile> 删除之前的文档成功..."),this.Save(t,this.getOfficeVersion(),this.FileType.substring(1).toUpperCase())}catch(t){return this.Status=t.description,this.ConsoleOut("<WebSaveLocalFile> 保存本地文件失败..."+t.description),this.Status="保存本地文档失败",-1}},this.WebOpenLocalFile=function(t){if(this.ConsoleOut("<WebOpenLocalFile> 开始..."),this.getDocType(this.FileType)==this.DocType.PICTURE)try{return this.obj.ActiveDocument.WebOpenLocalFile(t),this.Status="打开本地文档成功",0}catch(t){return this.Status="打开本地文档失败",-1}return this.obj.Open(t)},this.WebGetBookMarks=function(t){return this.ConsoleOut("<WebGetBookMarks> 开始..."),this.ConsoleOut("<WebGetBookMarks> 判断书签是否存在..."),this.obj.ActiveDocument.BookMarks.Exists(t)?this.obj.ActiveDocument.Bookmarks.Item(t).Range.Text:(this.ConsoleOut("<WebGetBookMarks> 名称为"+t+"的书签在文档中不存在"),this.Status="名称为"+t+"的书签在文档中不存在","")},this.WebAddBookMarks=function(t,e){var i;return this.ConsoleOut("<WebAddBookMarks> 开始..."),this.ConsoleOut("<WebAddBookMarks> 判断书签是否存在..."),".doc"==this.FileType||".docx"==this.FileType?"-1"==this.obj.ActiveDocument.ProtectionType?this.obj.ActiveDocument.BookMarks.Exists(t)?(this.ConsoleOut("<WebAddBookMarks> 名称为"+t+"的书签在文档中不存在"),this.Status="名称为"+t+"的书签在文档中已存在",this.WebFindBookMarks(t),!1):(this.ConsoleOut("<WebAddBookMarks> 获取书签的长度..."),i=e.length,this.ConsoleOut("<WebAddBookMarks> 插入内容..."),this.obj.ActiveDocument.Application.Selection.TypeText(e),this.obj.ActiveDocument.Application.Selection.MoveLeft(1,1),this.ConsoleOut("<WebAddBookMarks> 获取书签的原始位置..."),e=this.obj.ActiveDocument.Application.Selection.Start,this.ConsoleOut("<WebAddBookMarks> 获取书签的最终位置..."),i=this.obj.ActiveDocument.Application.Selection.Start+i,this.obj.ActiveDocument.Range(e,i).Select(),this.ConsoleOut("<WebAddBookMarks> 添加书签..."),this.obj.ActiveDocument.Bookmarks.Add(t),this.ConsoleOut("<WebAddBookMarks> 结束..."),this.Status="光标处添加书签成功",!0):!(this.Status="文档被锁定，操作失败"):!(this.Status="非Word文档，操作失败")},this.WebFindBookMarks=function(t){return this.ConsoleOut("<WebFindBookMarks> 开始..."),this.ConsoleOut("<WebFindBookMarks> 判断书签是否存在..."),".doc"==this.FileType||".docx"==this.FileType?"-1"==this.obj.ActiveDocument.ProtectionType?this.obj.ActiveDocument.BookMarks.Exists(t)?(this.obj.Range,this.obj.ActiveDocument.Bookmarks.Item(t).Range.Select(),this.ConsoleOut("<WebFindBookMarks> 书签定位成功..."),this.Status="已定位到书签",!0):(this.ConsoleOut("<WebFindBookMarks> 名称为"+t+"的书签在文档中不存在"),this.Status="名称为"+t+"的书签在文档中不存在",!1):!(this.Status="文档被锁定，操作失败"):!(this.Status="非Word文档，操作失败")},this.WebDelBookMarks=function(t){return this.ConsoleOut("<WebDelBookMarks> 开始..."),this.ConsoleOut("<WebDelBookMarks> 判断书签是否存在..."),".doc"==this.FileType||".docx"==this.FileType?"-1"==this.obj.ActiveDocument.ProtectionType?this.obj.ActiveDocument.BookMarks.Exists(t)?(this.ConsoleOut("<WebDelBookMarks> 开始删除书签..."),this.obj.ActiveDocument.Bookmarks.Item(t).Delete(),this.ConsoleOut("<WebDelBookMarks> 删除书签成功..."),this.Status="删除书签成功",!0):(this.ConsoleOut("<WebDelBookMarks> 名称为"+t+"的书签在文档中不存在"),this.Status="名称为"+t+"的书签在文档中不存在",!1):!(this.Status="文档被锁定，操作失败"):!(this.Status="非Word文档，操作失败")},this.WebSetBookmarks=function(t,e){if(".doc"!=this.FileType&&".docx"!=this.FileType)return!(this.Status="非Word文档，插入失败");if("-1"!=this.obj.ActiveDocument.ProtectionType)return!(this.Status="插入失败，文档被锁定");this.ConsoleOut("<WebSetBookmarks> 开始...");try{var i;return(this.ConsoleOut("<WebSetBookmarks> 判断书签是否存在..."),this.obj.ActiveDocument.BookMarks.Exists(t))?((i=this.obj.ActiveDocument.Bookmarks.Item(t).Range).text=e,this.obj.ActiveDocument.Bookmarks.Add(t,i),this.ConsoleOut("<WebSetBookmarks> 书签赋值成功..."),this.Status="书签赋值成功",!0):(this.Status="名称为"+t+"的书签在文档中不存在",!1)}catch(t){return this.Status=t.description,!1}},this.WebToolsVisible=function(t,e){return!(this.Status="该功能暂未提供!")},this.WebToolsEnable=function(t,e,i){return!(this.Status="该功能暂未提供!")},this.WebOpenPrint=function(){this.setShowDialog(this.ShowDialog.DialogPrint)},this.WebOpenPicture=function(){".doc"==this.FileType||".docx"==this.FileType||".wps"==this.FileType?this.obj.ActiveDocument.Application.Dialogs.Item(163).Show():".xls"!=this.FileType&&".xlsx"!=this.FileType&&".et"!=this.FileType||this.obj.ActiveDocument.Application.Dialogs.Item(342).Show()},this.WebRefresh=function(){this.obj.Activate(!0)},this.WebSetRevision=function(t,e,i,s){return this.ConsoleOut("<WebSetRevision> 开始..."),this.ConsoleOut("<WebSetRevision> 判断是不是Word格式..."),this.getDocType(this.FileType)==this.DocType.WORD?(this.obj.ActiveDocument.TrackRevisions=e,this.ConsoleOut("<WebSetRevision> 设置标记成功..."),this.obj.ActiveDocument.ShowRevisions=t,this.ConsoleOut("<WebSetRevision> 设置痕迹成功..."),this.obj.ActiveDocument.PrintRevisions=i,this.ConsoleOut("<WebSetRevision> 设置打印痕迹成功..."),s&&(this.obj.RibbonCustomUI='<customUI xmlns="http://schemas.microsoft.com/office/2006/01/customui" onLoad="OnLoad" loadImage="LoadImage">  <ribbon startFromScratch="false">    <tabs>      <tab idMso="TabReviewWord" visible="false">     </tab>     </tabs>   </ribbon>  </customUI>'),this.ConsoleOut("<WebSetRevision> 设置审阅工具栏成功..."),this.Status="设置痕迹成功",!0):(this.ConsoleOut("<WebSetRevision> 非word文档，无法执行。。。 "),!(this.Status="非word文档，无法执行"))},this.WebSetProtect=function(t,e){var i=this.getDocType(this.FileType);""==e&&(e=this.PASSWORD),t?this.VBAProtectDocument(i,e):this.VBAUnProtectDocument(i,e)},this.WebDownLoadFile=function(t,e){(new Date).getTime();var i=this.obj.Http;return i.Clear(),i.ShowProgressUI=!0,i.Hidden=!1,this.ConsoleOut("<WebDownLoadFile> 开始..."),this.ConsoleOut("<WebDownLoadFile> 开始打开服务器..."),i.Open(0,t,!1)?i.Send()?200==i.Status?(i.ResponseSaveToFile(e),this.ConsoleOut("<WebDownLoadFile>下载成功"),this.Status="下载成功",!0):(this.ConsoleOut("<WebDownLoadFile>下载失败"),!(this.Status="下载失败请检查URL是否正确")):(this.ConsoleOut("<WebDownLoadFile> 数据包发送失败..."),this.Status="数据包发送失败",this.ConsoleOut("<WebDownLoadFile> 结束..."),!1):(this.ConsoleOut("<WebDownLoadFile> 打开连接失败..."),this.Status="打开连接失败",i.Clear(),this.ConsoleOut("<WebDownLoadFile> 结束..."),!1)},this.WebMkDirectory=function(t){return this.ConsoleOut("<WebMkDirectory> 开始建立本地目录..."),this.obj.FileSystem.CreateDirectory(t)?(this.ConsoleOut("<WebMkDirectory> 建立本地目录成功..."),this.Status="创建目录成功",!0):(this.ConsoleOut("<WebMkDirectory> 建立本地目录失败..."),!(this.Status="创建目录失败检查是否已经有此目录或者路径不对"))},this.WebRmDirectory=function(t){return this.ConsoleOut("<WebRmDirectory> 删除本地目录..."),this.obj.FileSystem.ClearDirectory(t),this.ConsoleOut("<WebRmDirectory> 删除本地目录成功..."),this.Status="删除目录成功",!0},this.WebFileExists=function(t){return!(this.Status="该功能暂未提供!")},this.WebFileSize=function(t){this.ConsoleOut("<WebFileSize> 得到某文件的大小...");t=this.obj.FileSystem.GetFileSize(t);return 0==t?(this.ConsoleOut("<WebFileSize> 获取文件失败，请检查对应路径..."),this.Status="请检查文件路径是否有误",0):(this.ConsoleOut("<WebFileSize> 获取文件成功大小："+t+"字节"),this.Status="获取成功大小为"+t+"字节",t)},this.WebFileDate=function(t){return!(this.Status="该功能暂未提供!")},this.DisableMenu=function(t){return this.obj.CustomMenu.DisableMenu(MenuFile,t)},this.EnableMenu=function(t){return this.obj.CustomMenu.EnableMenu(MenuFile,t)},this.DisableKey=function(t){return!(this.Status="该功能暂未提供!")},this.WebOpenKey=function(t,e){this.ConsoleOut("<WebOpenKey> 开始..."),root=t,rootValue=e;t=this.obj.Register,this.ConsoleOut("<WebOpenKey> 建立注册表对象..."),e=t.QueryStringValue(root,rootValue,"");return e?(this.ConsoleOut("<WebOpenKey> 建立注册对象成功..."),this.Status="建立注册对象成功",this.ConsoleOut("<WebOpenKey> 结束..."),!0):(this.ConsoleOut("<WebOpenKey> 建立注册对象失败，注册表对象不存在，开始新建注册表对象..."),t.SetStringValue(root,rootValue,"",""),this.ConsoleOut("<WebOpenKey> 新建注册表对象成功..."),this.Status="建立注册对象失败，已新建注册表对象",this.ConsoleOut("<WebOpenKey> 结束..."),e)},this.WebWriteString=function(t,e){this.ConsoleOut("<WebWriteString> 开始...");var i=this.obj.Register;return null!=root&&null!=rootValue?(this.ConsoleOut("<WebWriteString> 开始写入注册表项的值..."),i=i.SetStringValue(root,rootValue,t,e),this.ConsoleOut("<WebWriteString> 写入注册表成功..."),this.Status="写入注册表成功",this.ConsoleOut("<WebWriteString> 结束..."),i):(this.ConsoleOut("<WebWriteString> 写入注册表失败，请先调用WebOpenKey接口..."),this.Status="写入注册表失败，请先调用WebOpenKey接口",this.ConsoleOut("<WebWriteString> 结束..."),!1)},this.WebReadString=function(t){this.ConsoleOut("<WebReadString> 开始...");var e=this.obj.Register;return null!=root&&null!=rootValue?(this.ConsoleOut("<WebReadString> 开始读取由注册表项的值..."),null!=(e=e.QueryStringValue(root,rootValue,t))||""!=e?(this.ConsoleOut("<WebReadString> 读取注册表成功..."),this.Status="读取注册表成功"):(this.ConsoleOut("<WebReadString> 读取失败，没有对应的注册表..."),this.Status="读取失败，没有对应的注册表"),this.ConsoleOut("<WebReadString> 结束..."),e):(this.ConsoleOut("<WebReadString> 写入注册表失败，请先调用WebOpenKey接口..."),this.Status="读取注册表失败，请先调用WebOpenKey接口",this.ConsoleOut("<WebReadString> 结束..."),!1)},this.WebWriteInteger=function(t,e){this.ConsoleOut("<WebWriteInteger> 开始...");var i=this.obj.Register;return null!=root&&null!=rootValue?(this.ConsoleOut("<WebWriteInteger> 开始写入注册表项的值..."),i=i.SetDWordValue(root,rootValue,t,e),this.ConsoleOut("<WebWriteInteger> 写入注册表成功..."),this.Status="写入注册表成功",this.ConsoleOut("<WebWriteInteger> 结束..."),i):(this.ConsoleOut("<WebWriteInteger> 写入注册表失败，请先调用WebOpenKey接口..."),this.Status="写入注册表失败，请先调用WebOpenKey接口",this.ConsoleOut("<WebWriteInteger> 结束..."),!1)},this.WebReadInteger=function(t){this.ConsoleOut("<WebReadInteger> 开始...");var e=this.obj.Register;return null!=root&&null!=rootValue?(this.ConsoleOut("<WebReadInteger> 开始读取注册表项的值..."),null!=(e=e.QueryDWORDValue(root,rootValue,t))||""!=e?(this.ConsoleOut("<WebReadInteger> 读取注册表成功..."),this.Status="读取注册表成功"):(this.ConsoleOut("<WebReadInteger> 读取失败，没有对应的注册表..."),this.Status="读取失败，没有对应的注册表"),this.ConsoleOut("<WebReadInteger> 结束..."),e):(this.ConsoleOut("<WebReadInteger> 读取注册表失败，请先调用WebOpenKey接口..."),this.Status="读取注册表失败，请先调用WebOpenKey接口",this.ConsoleOut("<WebReadInteger> 结束..."),!1)},this.WebCloseKey=function(){return this.ConsoleOut("<WebReadInteger> 开始关闭注册表作对象..."),rootValue=root=void 0,this.ConsoleOut("<WebReadInteger> 关闭注册表对象结束..."),!0},this.ShowDate=function(t,e){return!(this.Status="该功能暂未提供!")},this.WebApplication=function(t){return!(this.Status="该功能暂未提供!")},this.SignatureColor=function(t){return!(this.Status="该功能暂未提供!")},this.SignatureCount=function(t){return this.Status="该功能暂未提供!",0},this.GetSignature=function(t){return!(this.Status="该功能暂未提供!")},this.ClearRevisions=function(){if(this.getDocType(this.FileType)!=this.DocType.WORD||"-1"!=this.obj.ActiveDocument.ProtectionType)return this.ConsoleOut("非Word文档或文档已锁定，操作失败"),!1;this.ConsoleOut("<ClearRevisions> 接受当前文档中所有的痕迹...");try{return this.obj.Activate(!0),this.ConsoleOut("<ClearRevisions> 激活当前文档焦点成功..."),this.obj.ActiveDocument.AcceptAllRevisions(),this.obj.ActiveDocument.Revisions.AcceptAll(),this.ConsoleOut("<ClearRevisions> 接受痕迹成功..."),this.Status="痕迹接受成功",0<=this.obj.ActiveDocument.Revisions.Count}catch(t){return this.ConsoleOut("<ClearRevisions> 接受痕迹失败..."+t.description),this.Status="痕迹接受失败，错误原因："+t.description,!1}},this.WebDelTree=function(t){return this.ConsoleOut("<WebDelTree> 删除目录下的文件..."),this.obj.FileSystem.ClearDirectory(t),this.ConsoleOut("<WebDelTree> 删除成功..."),!0},this.WebGetFileContent=function(t){return this.Status="该功能暂未提供!",""},this.Version=function(){return this.obj.Version},this.VersionEx=function(){return!(this.Status="该功能暂未提供!")},this.PrintByCopies=function(t,e){var i;return parseInt(t),this.ConsoleOut("<PrintByCopies> 开始..."),i=this.obj.ActiveDocument.Application.Name,this.ConsoleOut("<PrintByCopies> 判断文档是否是word类型..."),"Microsoft Word"==i?(this.ConsoleOut("<PrintByCopies> 调用打印机功能..."),i=this.obj.ActiveDocument.Application.Dialogs.Item(88),this.ConsoleOut("<PrintByCopies> 是否调用打印机窗口..."),e?(this.ConsoleOut("<PrintByCopies> 设置带窗口的打印份数..."),i.NumCopies=t,this.ConsoleOut("<PrintByCopies> 启用打印机窗口..."),-1==i.Display?(this.ConsoleOut("<PrintByCopies> 开始打印..."),i.Execute,this.ConsoleOut("<PrintByCopies> 打印成功..."),this.Status="打印成功",this.ConsoleOut("<PrintByCopies> 结束..."),!0):(this.ConsoleOut("<PrintByCopies> 启用打印机窗口失败..."),this.Status="启用打印机窗口失败",this.ConsoleOut("<PrintByCopies> 结束..."),!1)):(this.ConsoleOut("<PrintByCopies> 不启用打印机窗口..."),this.ConsoleOut("<PrintByCopies> 设置不带窗口打印份数..."),i.NumCopies=t,this.ConsoleOut("<PrintByCopies> 开始打印..."),i.Execute,this.Status="打印成功",this.ConsoleOut("<PrintByCopies> 结束..."),!0)):(this.ConsoleOut("<PrintByCopies> 文档不是word类型..."),this.Status="文档不是word类型",this.ConsoleOut("<PrintByCopies> 结束..."),!1)},this.WebGetCpuID=function(){return!(this.Status="该功能暂未提供!")},this.WebGetIdeID=function(){return!(this.Status="该功能暂未提供!")},this.BuildContentFromHTML=function(t){return!(this.Status="该功能暂未提供!")},this.WebRunMacro=function(t,e){try{var i=e;return this.obj.ActiveDocument.VBProject.VBComponents.Add(1).CodeModule.AddFromString(i),this.obj.ActiveDocument.Application.Run(t),!0}catch(t){return!1}},this.WebDocumentCompare=function(t,e,i,s){this.ConsoleOut("<WebDocumentCompare> 文档对比开始..."),this.Status="";this.obj.FileSystem;var o,n=this.DownFilePath(),h=n+Math.round(1e8*Math.random())+".doc";return null==t||""==t?null==i||""===i?!(this.Status="【FileName2】不能为空!"):(this.ConsoleOut("<WebDocumentCompare>与当前文档进行对比 "),this.ConsoleOut("<WebDocumentCompare> 开始下载..."+i),this.WebDownloadFile_int(i,s)?(this.ConsoleOut("<WebDocumentCompare> 文件【"+i+"】下载成功"),t=this.FileName,this.WebSaveLocalFile(n+t),this.ConsoleOut("<WebDocumentCompare> 开始把当前文档下载到本地..."),this.WebClose(),this.ConsoleOut("<WebDocumentCompare> 开始文档对比..."),1==(o=this.obj.FuncExtModule.WebDocumentCompare(n+t,this.DownloadedFileTempPathName,h))?(this.ConsoleOut("<WebDocumentCompare> 文档对比成功"),this.obj.Open(h),this.ConsoleOut("<WebDocumentCompare> 文档对比成功打开最终文档..."),this.obj.ActiveDocument.Application.ActiveWindow.View.type=3,this.obj.ActiveDocument.Application.ActiveWindow.View.SplitSpecial=20,!0):(this.ConsoleOut("<WebDocumentCompare> 文档对比失败,请确认待对比的文档是否能够正常打开!"),!(this.Status="文档对比失败,请确认待对比的文档是否能够正常打开!"))):(this.ConsoleOut("<WebDocumentCompare> 文件【"+i+"】下载失败，该文档可能在服务器不存在!"),this.Status="文件【"+i+"】下载失败，该文档可能在服务器不存在!",!1)):(this.ConsoleOut("<WebDocumentCompare> 后台两个文档进行对比 "),null==i||""==i?!(this.Status="【FileName2】不能为空!"):(this.ConsoleOut("<WebDocumentCompare> 分别下载两个文档 "),this.WebDownloadFile_int(t,e)?(this.ConsoleOut("<WebDocumentCompare> 文件【"+t+"】下载成功"),this.WebDownloadFile_int(i,s)?(this.ConsoleOut("<WebDocumentCompare> 文件【"+i+"】下载成功"),this.WebClose(),o=this.obj.FuncExtModule.WebDocumentCompare(n+t,n+i,h),this.ConsoleOut("<WebDocumentCompare> 开始文档对比 "),1==o?(this.ConsoleOut("<WebDocumentCompare> 文档对比成功..."),this.obj.Open(h),this.ConsoleOut("<WebDocumentCompare> 文档对比成功打开最终文档..."),this.obj.ActiveDocument.Application.ActiveWindow.View.type=3,this.obj.ActiveDocument.Application.ActiveWindow.View.SplitSpecial=20,this.NewShowMenu(this.ShowMenu),this.NewShowToolBar(this.ShowToolBar),this.obj.ActiveDocument.TrackRevisions=!0,this.obj.ActiveDocument.ShowRevisions=!0):(this.ConsoleOut("<WebDocumentCompare> 文档对比失败,请确认待对比的文档是否能够正常打开!"),!(this.Status="文档对比失败,请确认待对比的文档是否能够正常打开!"))):(this.ConsoleOut("<WebDocumentCompare> 文件【"+i+"】下载失败，该文档可能在服务器不存在!"),this.Status="文件【"+i+"】下载失败，该文档可能在服务器不存在!",!1)):(this.ConsoleOut("<WebDocumentCompare> 文件【"+t+"】下载失败，该文档可能在服务器不存在!"),this.Status="文件【"+t+"】下载失败，该文档可能在服务器不存在!",!1)))},this.WebSetSkin=function(t,e,i,s,o,n,h){this.Status="";var a=this.obj.Style;try{return a.TitleBarColor=t,a.TitleBarTextColor=null==h||""==h?0:h,a.MenuBarStartColor=e,a.MenuBarEndColor=16777215,a.MenuBarTextColor=0,a.MenuBarHighlightTextColor=0,a.MenuBarButtonStartColor=i,a.MenuBarButtonEndColor=s,a.MenuBarButtonFrameColor=o,a.CustomToolbarStartColor=n,a.CustomToolbarEndColor=n,a.Invalidate(),!0}catch(t){return this.Status="皮肤设置错误，错误信息为："+t.description,!1}},this.WebEnableCopy=function(t){switch(this.ConsoleOut("<WebEnableCopy> 开始 "),t){case 0:case!1:case"0":this.obj.CopyEnabled=!1,this.ConsoleOut("<WebEnableCopy> 不允许Copy "),this.Status="禁止复制";break;case 1:case"1":case!0:this.obj.CopyEnabled=!0,this.ConsoleOut("<WebEnableCopy> 允许Copy "),this.Status="允许复制";break;default:return}},this.VBAShowRevisions=function(t){return this.ConsoleOut("<VBAShowRevisions> 开始隐藏痕迹。。。 "),this.getDocType(this.FileType)==this.DocType.WORD&&"-1"==this.obj.ActiveDocument.ProtectionType?(this.obj.ActiveDocument.TrackRevisions=t,this.obj.ActiveDocument.ShowRevisions=t,this.ConsoleOut("<VBAShowRevisions> 隐藏痕迹成功 "),this.Status="隐藏痕迹成功",!0):(this.ConsoleOut("<VBAShowRevisions> 非Office文档或文档已被锁定，无法执行操作 "),!(this.Status="非Office文档或文档已被锁定，无法执行操作"))},this.VBAProtectDocument=function(t,e){return this.ConsoleOut("<VBAProtectDocument> 开始。。。 "),t==this.DocType.WORD?"-1"==this.obj.ActiveDocument.ProtectionType?(this.obj.ActiveDocument.Protect(2,!1,e),this.ConsoleOut("<VBAProtectDocument> 文档锁定成功。。。 "),this.Status="文档已被锁定",!0):(this.ConsoleOut("<VBAProtectDocument> 文档锁定失败。。。 "),!(this.Status="文档锁定失败")):t!=this.DocType.EXECL?(this.ConsoleOut("<VBAProtectDocument> 非Office文档，无法执行锁定操作。。。 "),!(this.Status="非Office文档，无法执行锁定操作")):this.obj.ActiveDocument.Application.Sheets(1).ProtectContents?(this.ConsoleOut("<VBAProtectDocument> 文档锁定失败。。。 "),!(this.Status="文档锁定失败")):(this.obj.ActiveDocument.Application.Sheets(1).Protect(e),this.ConsoleOut("<VBAProtectDocument> 文档锁定成功。。。 "),void(this.Status="文档锁定成功"))},this.VBAUnProtectDocument=function(t,e){return this.ConsoleOut("<VBAUnProtectDocument> 开始。。。 "),(t=this.getDocType(this.FileType))==this.DocType.WORD?(this.obj.ActiveDocument.Unprotect(e),this.ConsoleOut("<VBAUnProtectDocument> WORD解除保护。。。 "),this.Status="WORD解除保护",!0):t==this.DocType.EXECL?(this.obj.ActiveDocument.Application.Sheets(1).Unprotect(e),this.ConsoleOut("<VBAUnProtectDocument> EXCEL解除保护。。。 "),this.Status="解除保护",!0):(this.ConsoleOut("<VBAUnProtectDocument> 非Office文档，无法执行解锁操作。。。 "),!(this.Status="非Office文档，无法执行解锁操作"))},this.VBAInsertFile=function(t,e){this.ConsoleOut("<VBAInsertFile> 开始。。。 ");try{var i=this.getDocType(this.FileType);return this.ConsoleOut("<VBAInsertFile> 判断是否是WORD。。。 "),i==this.DocType.WORD?(this.ConsoleOut("<VBAInsertFile> 判断书签是否存在。。。 "),this.obj.Activate(!0),this.obj.ActiveDocument.BookMarks.Exists(t)&&(setTimeout(this.obj.ActiveDocument.Application.Selection.GoTo(-1,0,0,t),200),this.ConsoleOut("<VBAInsertFile> 跳转到书签指定位置。。。 ")),this.obj.Activate(!0),this.ConsoleOut("<VBAInsertFile> 激活当前对象。。。 "),this.obj.ActiveDocument.Application.Selection.InsertFile(e,"",!1,!1,!1),this.ConsoleOut("<VBAInsertFile> 插入。。。 "+e+"...成功"),!0):(this.Status="非Office文档，无法执行插入文档操作",this.ConsoleOut("<VBAInsertFile> 非Office文档，无法执行插入文档操作。。。 "),!1)}catch(t){return this.Status="插入文档失败，错误原因："+t.description,this.ConsoleOut("插入文档失败，错误原因："+t.description),!1}},this.WebAcceptAllRevisions=function(){return!(this.Status="该功能暂未提供!")},this.VBASetUserName=function(t){if(".ppt"!=this.FileType&&".pptx"!=this.FileType){this.ConsoleOut("<VBASetUserName> 开始。。。 ");try{return this.OfficeUserName=this.obj.ActiveDocument.Application.UserName,this.obj.ActiveDocument.Application.UserName=t,this.obj.ActiveDocument.Application.UserInitials=t,this.ConsoleOut("<VBASetUserName> 设置WORD编辑名成功。。。 "),!0}catch(t){return!1}}},this.ShowField=function(){try{return this.obj.ActiveDocument.ActiveWindow.View.ShowDrawings=!0,!(this.obj.ActiveDocument.ActiveWindow.View.ShowFieldCodes=!1)}catch(t){return this.Status="设置域失败，错误原因："+t.description,!1}},this.WebAreaProtect=function(t){if(this.ConsoleOut("<WebAreaProtect> 开始。。。 "),".doc"!=this.FileType&&".docx"!=this.FileType)return this.ConsoleOut("<WebAreaProtect> 非Office文档，无法执行区域保护操作! "),!(this.Status="非Office文档，无法执行区域保护操作!");if(!this.obj.ActiveDocument.BookMarks.Exists(t))return this.ConsoleOut("<WebAreaProtect> 文件内没有名称为'"+t+"'的书签 ,请先添加书签!"),this.Status="文件内没有名称为'"+t+"'的书签 ,请先添加书签!",!1;this.obj.Range,this.obj.ActiveDocument.Bookmarks.Item(t).Range.Select(),this.ConsoleOut("<WebAreaProtect> 选中书签位置。。。 "),this.obj.ActiveDocument.bookmarks.Item(t).range.editors.add(-1),this.obj.ActiveDocument.Protect(3,!1,"123",!1,!1),this.ConsoleOut("<WebAreaProtect> 保护书签内容。。。 ");return this.obj.ActiveDocument.Application.Selection.MoveLeft(1,1),this.obj.ActiveDocument.ActiveWindow.View.ShadeEditableRanges=!1,this.ConsoleOut("<WebAreaProtect> 突出显示可编辑区域。。。 "),this.Status="操作成功，书签区域可编辑",!0},this.WebAreaUnprotect=function(t){if(this.ConsoleOut("<WebAreaUnprotect> 开始。。。 "),".doc"!=this.FileType&&".docx"!=this.FileType)return this.ConsoleOut("<WebAreaUnprotect> 非Office文档，无法执行取消区域保护操作!"),!(this.Status="非Office文档，无法执行取消区域保护操作!");if(this.ConsoleOut("<WebAreaUnprotect> 判断书签是否存在。。。 "),!this.obj.ActiveDocument.BookMarks.Exists(t))return this.ConsoleOut("<WebAreaUnprotect> 文档中不存在<"+t+">的书签"),this.Status="文档中不存在<"+t+">的书签",!1;try{this.ConsoleOut("<WebAreaUnprotect> 解保护。。。 "),this.obj.ActiveDocument.Unprotect("123");this.obj.Range;return this.obj.ActiveDocument.Bookmarks.Item(t).Range.Select(),this.ConsoleOut("<WebAreaUnprotect> 选中书签内容。。。 "),this.obj.ActiveDocument.DeleteAllEditableRanges(-1),this.ConsoleOut("<WebAreaUnprotect> 去掉突出显示。。。 "),this.Status="书签区域"+t+"可以编辑",!0}catch(t){return this.ConsoleOut("<WebAreaUnprotect> 执行取消区域保护时出现错误，错误原因："+t.description),this.Status="执行取消区域保护时出现错误，错误原因："+t.description,!1}},this.Activate=function(t){this.obj.Activate(t)},this.WebPageCode=function(){this.blnIE()?this.obj.ActiveDocument.Application.Dialogs(294).Show():this.ExecuteScript("WebPageCode","ActiveObject.ActiveDocument.Application.Dialogs(294).Show()")},this.ExecuteScript=function(t,e){this.obj.ExecuteScript(t,e)},this.ShowTitleBar=function(t){this.obj.Style.ShowTitleBar=t},this.ShowCustomToolBar=function(t){this.obj.Style.ShowCustomToolbar=t},this.ShowMenuBar=function(t){this.obj.Style.ShowMenuBar=t},this.ShowToolBars=function(t){var e=this.obj.Style;e.ShowToolBars=t,e.ShowToolSpace=t},this.ShowStatusBar=function(t){this.obj.Style.ShowStatusBar=t},this.ShowCustomToolbar=function(t){this.obj.Style.ShowCustomToolbar=t},this.WebShow=function(t){this.getDocType(this.FileType)==this.DocType.WORD&&this.VBAShowRevisions(t)},this.SaveEnabled=function(t){this.obj.SaveEnabled=t},this.PrintEnabled=function(t){this.obj.PrintEnabled=t},this.HookEnabled=function(){this.getDocType(this.FileType)==this.DocType.WORD&&(this.obj.Style.ShowToolSpace=!0,this.obj.SelectionInformationEnabled=!1),null!=window.ActiveXObject||null!=window.ActiveXObject||"ActiveXObject"in window||(this.obj.HookEnabled=!1)},this.ClearDirectory=function(){this.ConsoleOut("<ClearDirectory> 开始...");var t=this.obj.FileSystem;t.ClearDirectory(this.DownFilePath()),this.ConsoleOut("<ClearDirectory> 清除Down里面文件成功..."),t.ClearDirectory(this.getFilePath()),this.ConsoleOut("<ClearDirectory> 清除UP里面文件成功..."),this.ConsoleOut("<ClearDirectory> 结束...")},this.WebDelLocalFile=function(t){this.obj.FileSystem.DeleteFile(t)},this.GetMessageString=function(){return this.ht.toString()},this.WebSetRibbonUIXML=function(t){this.obj.RibbonCustomUI=t},this.WebSetMaxFileSize=function(t){return!(this.WebFileSize(t)>1024*this.MaxFileSize)},this.DownFilePath=function(){var t=this.obj.FileSystem,t=this.HiddenDirectory?t.GetSpecialFolderLocation(32)+this.DOWN+t.GetFolderEncryptCode(1)+"\\":t.GetSpecialFolderPath(26)+this.DOWN;return t},this.getFilePath=function(){var t=this.obj.FileSystem,e=this.HiddenDirectory?t.GetSpecialFolderLocation(32)+this.UP+t.GetFolderEncryptCode(1)+"\\":t.GetSpecialFolderLocation(26)+this.UP;return t.CreateDirectory(e),this.FilePath=e,this.FilePath},this.WebSetAllowEmpty=function(){return".doc"!=this.FileType||1!=this.WebObject.ActiveDocument.Content.Text.length},this.NewCopyType=function(t){switch(t){case 0:case!1:case"0":this.obj.CopyEnabled=!1;break;case 1:case"1":case!0:this.obj.CopyEnabled=!0;break;default:return}},this.NewShowMenu=function(t){var e=this.obj.Style;switch(t){case 0:case!1:case"0":e.ShowMenuBar=!1;break;case 1:case"1":case!0:e.ShowMenuBar=!0;break;default:return}},this.NewShowToolBar=function(t){var e=this.obj.Style;switch(t){case!1:e.ShowCustomToolbar=!1,e.ShowToolBars=!0;break;case!0:e.ShowCustomToolbar=!0,e.ShowToolBars=!0;break;case 0:e.ShowCustomToolbar=!1,e.ShowToolBars=!0;break;case 1:e.ShowCustomToolbar=!0,e.ShowToolBars=!0;break;case 2:e.ShowCustomToolbar=!1,e.ShowToolBars=!1;break;case 3:e.ShowCustomToolbar=!0,e.ShowToolBars=!1}},this.NewUIControl=function(t){var e;switch(t){case!1:e='<customUI xmlns="http://schemas.microsoft.com/office/2006/01/customui" onLoad="OnLoad" loadImage="LoadImage"> \t\t\t            <commands> \t\t\t      \t    \t<command idMso="FileSave" enabled="false" "/> \t\t\t      \t  \t\t<command idMso="FileSaveAs" enabled="false" /> \t\t\t            </commands> \t\t    \t\t</customUI>';break;case!0:e='<customUI xmlns="http://schemas.microsoft.com/office/2006/01/customui" onLoad="OnLoad" loadImage="LoadImage"> \t\t\t\t        <commands> \t\t\t\t  \t    \t<command idMso="FileSave" enabled="true" /> \t\t\t\t  \t  \t\t<command idMso="FileSaveAs" enabled="true" /> \t\t\t\t        </commands> \t\t\t\t\t</customUI>'}this.obj.RibbonCustomUI=e},this.ModifyReview=function(){for(i=1;i<=this.obj.ActiveDocument.Application.CommandBars("Track Changes").Controls.Count;i++)1715==this.obj.ActiveDocument.Application.CommandBars("Track Changes").Controls.Item(i).ID&&(this.obj.ActiveDocument.Application.CommandBars("Track Changes").Controls.Item(i).Enabled=!1),1716==this.obj.ActiveDocument.Application.CommandBars("Track Changes").Controls.Item(i).ID&&(this.obj.ActiveDocument.Application.CommandBars("Track Changes").Controls.Item(i).Enabled=!1),2041==this.obj.ActiveDocument.Application.CommandBars("Track Changes").Controls.Item(i).ID&&(this.obj.ActiveDocument.Application.CommandBars("Track Changes").Controls.Item(i).Enabled=!1);this.obj.RibbonCustomUI='<customUI xmlns="http://schemas.microsoft.com/office/2006/01/customui" onLoad="OnLoad" loadImage="LoadImage"> \t        <commands> \t    \t    <command idMso="ReviewReviewingPaneMenu" enabled="false"/> \t    \t\t<command idMso="ReviewShowMarkupMenu" enabled="false"/> \t        \t<command idMso="ReviewTrackChangesMenu" enabled="false"/> \t        \t<command idMso="ReviewRejectChangeMenu" enabled="false"/> \t\t\t\t<command idMso="ReviewAcceptChangeMenu" enabled="false"/> \t        \t<command idMso="ReviewNewComment" enabled="false"/> \t    \t\t<command idMso="ReviewDeleteCommentsMenu" enabled="false"/> \t        </commands> \t      </customUI>'},this.RemoveRevise=function(){var t=0,e=this.obj.ActiveDocument.Application.CommandBars.Item("Track Changes").Controls;for(i=1;i<=e.Count;i++){if(3==t)return;var s=e.Item(i).ID;1715==s?(e.Item(i).Visible=!1,e.Item(i).Enabled=!1,t+=1):1716!=s&&2041!=s||(e.Item(i).Visible=!1,e.Item(i).Enabled=!1,t+=1)}},this.OfficeFastUI=function(){this.obj.RibbonCustomUI='<customUI xmlns="http://schemas.microsoft.com/office/2006/01/customui" onLoad="OnLoad" loadImage="LoadImage"> \t        <commands>  \t\t\t\t<command idMso="PrintPreviewAndPrint" enabled="false" /> \t        \t<command idMso="TabReviewWord" enabled="false" /> \t  \t    \t<command idMso="FileSave" enabled="false" /> \t  \t  \t\t<command idMso="FileSaveAs" enabled="false" /> \t  \t  \t\t<command idMso="FileNewDefault" enabled="false" /> \t  \t  \t\t<command idMso="FileOpen" enabled="false" /> \t  \t  \t\t<command idMso="FilePrintQuick" enabled="false" /> \t  \t  \t\t<command idMso="RedoOrRepeat" enabled="false" /> \t  \t  \t\t<command idMso="Undo" enabled="false" /> \t        </commands> \t\t</customUI>'},this.WebSetRibbonUIXML=function(){this.obj.RibbonCustomUI='<customUI xmlns="http://schemas.microsoft.com/office/2006/01/customui" onLoad="OnLoad" loadImage="LoadImage">     \t\t<ribbon startFromScratch="false">     \t\t\t<tabs> \t\t    \t\t<tab idMso="TabReviewWord" visible="false" />     \t\t\t\t<tab idMso="TabInsert" visible="false" />     \t\t\t\t<tab idMso="TabHome" visible="false" />     \t\t\t</tabs>     \t\t</ribbon>     \t\t</customUI>'},this.ShowDialog={DialogNew:0,DialogOpen:1,DialogSaveAs:2,DialogSaveCopyAs:3,DialogPrint:4,DialogPageSetup:5,DialogProperties:6},this.setObj=function(t){this.obj=t,this.WebObject=this.obj},this.DocType={WORD:0,EXECL:1,PPT:2},this.HttpMethod={Get:0,Post:1},this.SaveAsPdf=function(t){if(this.ConsoleOut("<WebSavePDF> 开始把PDF保存到本地..."),"11.0"!=this.obj.ActiveDocument.Application.Version)if(".doc"==this.FileType||".docx"==this.FileType||".wps"==this.FileType)try{return this.obj.ActiveDocument.ExportAsFixedFormat(t,17,!0),this.ConsoleOut("<WebSavePDF> 保存PDF到本地成功..."),this.Status="保存PDF到本地成功",!0}catch(t){return this.ConsoleOut("<WebSavePDF> 保存PDF异常..."+t.description),this.Status=t.description,alert("保存PDF异常,可能Office没有保存PDF功能，建议安装SaveAsPDFandXPS插件"),!1}else if(".xls"==this.FileType||".xlsx"==this.FileType||".et"==this.FileType)try{return this.obj.ActiveDocument.Application.ActiveWorkbook.ExportAsFixedFormat(0,t,0),this.ConsoleOut("<WebSavePDF> 保存PDF到本地成功..."),this.Status="保存PDF到本地成功",!0}catch(t){return this.ConsoleOut("<WebSavePDF> 保存异常..."+t.description),this.Status=t.description,alert("保存PDF异常,可能Office没有保存PDF功能，建议安装SaveAsPDFandXPS插件"),!1}else this.ConsoleOut("<WebSavePDF> 保存PDF异常,文档格式不对");else this.ConsoleOut("<WebSavePDF> 保存PDF异常,Office没有保存PDF功能"),this.Status="保存PDF异常,Office没有保存PDF功能",alert("保存PDF异常,Office没有保存PDF功能")},this.SaveAsHtml=function(t){if(".doc"==this.FileType||".docx"==this.FileType||".wps"==this.FileType)try{this.obj.ActiveDocument.SaveAs(t,8,!1,"",!1,"",!1,!1,!1,!1,!1,0);return this.obj.ActiveDocument.Application.ActiveWindow.View.type=3,!0}catch(t){return this.Status=t.description,!1}},this.ArrayList=function(){this.ObjArr={},this.Count=0,this.Add=function(t,e){return this.ObjArr[t]=e,this.Count++,!0},this.Get=function(t){return this.ObjArr[t]},this.Clear=function(){this.ObjArr={},this.Count=0},this.toString=function(){var t=new Array,e=0;for(e in this.ObjArr)t.push("'"+e+"':'"+this.ObjArr[e]+"'");return"{"+t+"}"}},this.ht=new this.ArrayList,this.getOpenDocSuffix=function(t){var e;return 5==t.length&&(t=t.substring(0,4)),e="",!this.isWPS()&&this.getOfficeVersion()||(e+="*"+t+"x|*"+t+"x|"),e=(e+="*"+t+"|*"+t+"|")+(this.getOpenSuffixName(t)+"(*"+t),!this.isWPS()&&this.getOfficeVersion()||(e+=";*"+t+"x"),e+=")|*"+t,!this.isWPS()&&this.getOfficeVersion()||(e+=";*"+t+"x"),e+="|"},this.WebDownloadFile_int=function(t,e){this.Status="";var i=this.obj.Http;if(i.Clear(),this.WebSetMsgByName("USERNAME",this.UserName),this.WebSetMsgByName("FILENAME",t),this.WebSetMsgByName("GETFILEPATH",e),this.WebSetMsgByName("FILETYPE",this.FileType),this.WebSetMsgByName("RECORDID",this.RecordID),this.WebSetMsgByName("OPTION","LOADFILE"),i.AddForm("FormData",this.GetMessageString()),this.WebClearMessage(),i.ShowProgressUI=this.ShowWindow,i.Open(this.HttpMethod.Post,this.WebUrl,!1)&&i.Send())return"404"==i.GetResponseHeader("MsgError")?(this.Status="文档【"+t+"】下载失败，请确认该文档在服务器上是否存在",i.Clear(),!1):(i.Clear(),this.hiddenSaveLocal(i,this,!1,!1,t)?(this.Status="文档下载成功",!0):!(this.Status="文档下载失败"))},this.SAVEFILE=function(t,e){return t.AddForm("FormData",this.GetMessageString()),t.AddFile("FileData",e),this.WebClearMessage(),t.ShowProgressUI=this.ShowWindow,this.ConsoleOut("<SAVEFILE> 开始打开链接..."),t.Open(this.HttpMethod.Post,this.WebUrl,!1)?(this.ConsoleOut("<SAVEFILE> 开始向后台发送数据包..."),t.Send()?(this.ConsoleOut("<SAVEFILE> 数据包发送成功，文档已成功保存到后台..."),!0):(this.ConsoleOut("数据包发送失败！请检查链接<"+this.WebUrl+">是否正确或网络是否畅通。"),this.Status="数据包发送失败！请检查链接<"+this.WebUrl+">是否正确或网络是否畅通。",!1)):(this.ConsoleOut("打开链接<"+this.WebUrl+">失败！请检查网络是否畅通。"),this.Status="打开链接<"+this.WebUrl+">失败！请检查网络是否畅通。",!1)},this.LOADFILE=function(t){if(this.Status="",t.ShowProgressUI=this.ShowWindow,this.ConsoleOut("<LOADFILE> 开始打开链接..."),!t.Open(this.HttpMethod.Post,this.WebUrl,!1))return this.Status="打开链接<"+this.WebUrl+">失败！请检查网络是否畅通。",!1;if(this.ConsoleOut("<LOADFILE> 链接打开成功，开始进行数据包发送..."),!t.Send())return this.Status="数据包发送失败！请检查链接<"+this.WebUrl+">是否正确或网络是否畅通。",!1;if(this.ConsoleOut("<LOADFILE> 数据包发送成功..."),"404"==t.GetResponseHeader("MsgError"))return this.ConsoleOut("<LOADFILE> 后台未找到对应文档，开始创建一个空白文档..."),this.CreateFile(),this.ConsoleOut("<LOADFILE> 空白文档创建成功..."),this.getOfficeVersion(),t.Clear(),!0;if(this.ConsoleOut("<LOADFILE> 开始将后台文档保存到本地..."),!this.hiddenSaveLocal(t,this,!1,!1))return!(this.Status="保存文档到本地 失败");this.ConsoleOut("<LOADFILE> 后台文档保存到本地成功，开始打开本地文档，路径为："+this.DownloadedFileTempPathName+"...");t=this.WebOpenLocalFile(this.DownloadedFileTempPathName);if(0==t)return this.ConsoleOut("<LOADFILE> 文档打开成功..."),this.getOfficeVersion(),!0;if(1==t){var e=window.confirm("可能当前授权码错误，请确认iWebOffice2015.js的授权是否正确（或乱码）\r\r单击“确定”关闭。单击“取消”继续。");if(this.Status="可能当前授权码错误，请确认iWebOffice2015.js的授权是否正确（或乱码）",1==e)return window.close(),!1}else if(2==t){e=window.confirm("没有找到文档，请确认WebOpenLocalFile打开文档的路径是否正确\r\r单击“确定”关闭。单击“取消”继续。");if(this.Status="有找到文档，请确认WebOpenLocalFile打开文档的路径是否正确",1==e)return window.close(),!1}else if(3==t){e=window.confirm("没有权限导致文档打开失败，请用管理员身份运行浏览器后重试\r\r单击“确定”关闭。单击“取消”继续。");if(this.Status="没有权限导致文档打开失败，请用管理员身份运行浏览器后重试",1==e)return window.close(),!1}else if(4==t){e=window.confirm("文件可能损坏，请确定服务器文档是否已经损坏\r\r单击“确定”关闭。单击“取消”继续。");if(this.Status="文件可能损坏，请确定服务器文档是否已经损坏",1==e)return window.close(),!1}else if(5==t){e=window.confirm("未安装Office或者注册表有损坏\r\r单击“确定”关闭。单击“取消”继续。");if(this.Status="未安装Office或者注册表有损坏",1==e)return window.close(),!1}else if(6==t){e=window.confirm("文件被占用，请结束Office进程后重试\r\r单击“确定”关闭。单击“取消”继续。");if(this.Status="文件被占用，请结束Office进程后重试",1==e)return window.close(),!1}else{this.ConsoleOut("<LOADFILE> 打开文档时未知错误！错误码为： "+t);e=window.confirm("打开文档时未知错误！错误码为： "+t+"\r\r单击“确定”关闭。单击“取消”继续。");if(this.Status="打开文档时未知错误！错误码为： "+t,1==e)return window.close(),!1}},this.hiddenSaveLocal=function(t,e,i,s,o){try{this.ConsoleOut("<hiddenSaveLocal> 开始保存文档到本地..."),this.Status="",i&&(t.Hidden=!0);var n="",h=e.obj.FileSystem,a=this.DownFilePath();return h.CreateDirectory(a),this.FilePath=a,null!=s&&1!=s||(n="temp"+e.RecordID,this.tempInsertName=n+this.FileName),null!=o&&""!=o||(o=this.FileName,o=1e5*Math.random()+this.FileType),this.DownloadedFileTempPathName=a+n+o,t.ResponseSaveToFile(this.DownloadedFileTempPathName),t.Clear(),this.ConsoleOut("<hiddenSaveLocal> 保存文档到本地结束..."),!0}catch(t){return this.ConsoleOut("<hiddenSaveLocal> 保存本地文档失败，错误信息为： "+t.description),!1}},this.Save=function(FileName,is2003,FileType){if(this.getDocType(this.FileType)==this.DocType.PICTURE)return this.obj.ActiveDocument.WebSaveLocalFile(FileName)?0:-1;if(is2003)return this.obj.Save(FileName);var SaveFalg=this.obj.Save(FileName,eval("this.DocTypeValue."+FileType),!0);return 80==SaveFalg?"文件路径无效":81==SaveFalg?"参数无效":82==SaveFalg?"文件创建失败":SaveFalg},this.blnIE=function(){return null!=window.ActiveXObject||null!=window.ActiveXObject||"ActiveXObject"in window},this.isWPS=function(){return".WPS"==this.FileType.toUpperCase()||".ET"==this.FileType.toUpperCase()},this.getOfficeVersion=function(){var t=0;try{return-1==this.setVersion?(t=parseFloat(this.obj.ActiveDocument.Application.Version),this.setVersion=t):t=this.setVersion,11==t?this.OfficeVersion.v2003:this.OfficeVersion.vOther}catch(t){return this.OfficeVersion.v2003}},this.getDocType=function(t){return".doc"==t||".docx"==t||".wps"==t?this.DocType.WORD:".xls"==t||".xlsx"==t||".et"==t?this.DocType.EXECL:".tif"==t||".jpg"==t?this.DocType.PICTURE:".ppt"==t||".pptx"==t?this.DocType.PPT:void 0},this.getOpenSuffixName=function(t){var e;switch(t){case this.DocType.WORD:e="Word Files";break;case this.DocType.EXECL:e="Excel Files";break;default:e="Word Files"}return e},this.setShowDialog=function(t,e){switch(t){case this.ShowDialog.DialogOpen:this.obj.ShowDialog(t,e,0);break;case this.ShowDialog.DialogNew:case this.ShowDialog.DialogPageSetup:case this.ShowDialog.DialogPrint:case this.ShowDialog.DialogProperties:case this.ShowDialog.DialogSaveCopyAs:case this.ShowDialog.DialogSaveAs:this.obj.ShowDialog(t)}},this.setEditType=function(t){try{switch(t){case 0:case"0":this.VBAProtectDocument(this.getDocType(this.FileType),"123");break;case 1:case"1":this.WebShow(!1);break;case 2:case"2":this.WebShow(!0)}}catch(t){return!1}},this.getEditVersion=function(){return this.obj.AppName},this.SetUser=function(t){this.obj.User=t},this.CheckFile=function(t){this.obj.bCheckFile=t},this.EnableSignature=function(t){try{this.obj.ActiveDocument.Application.COMAddIns.Item("iSignatureWord.WordApp").Connect=t}catch(t){return}},this.AddWaterMark=function(t){if(".doc"!=this.FileType&&".docx"!=this.FileType)return!(this.Status="非Word文档，插入水印失败");e=this.blnIE()?this.WebObject.ActiveDocument.Application.ActiveDocument.BuiltInDocumentProperties(14):this.WebObject.ActiveDocument.Application.ActiveDocument.BuiltInDocumentProperties.Item(14).Value();var e,i=parseInt(e),s=this.WebObject.ActiveDocument.Application.Selection;if("-1"!=this.obj.ActiveDocument.ProtectionType)return!(this.Status="文档被锁定，插入水印失败");this.DelWaterMark(t);for(var o=1;o<=i;o++){s.GoTo(1,1,1);try{this.WebObject.ActiveDocument.ActiveWindow.ActivePane.View.SeekView=9,this.WebObject.ActiveDocument.Application.Selection.ClearFormatting(),s.HeaderFooter.Shapes.AddTextEffect(0,t,"宋体",36,!1,!1,100,100).Select();var n=s.ShapeRange;n.Name=t+o,n.TextEffect.NormalizedHeight=!1,n.Line.Visible=!1,n.Fill.Visible=!0,n.Fill.Solid(),n.Fill.ForeColor.RGB=255,n.Fill.Transparency=.9,n.Rotation=60,n.LockAspectRatio=!0,n.Height=144,n.Width=576,n.WrapFormat.AllowOverlap=!0,n.WrapFormat.Side=3,n.WrapFormat.type=3,n.RelativeHorizontalPosition=0,n.RelativeVerticalPosition=0,n.Left=-999995,n.Top=-999995,this.WebObject.ActiveDocument.ActiveWindow.ActivePane.View.SeekView=0,this.Status="插入水印成功"}catch(t){return this.Status="插入水印失败"+t.description,!1}}return!0},this.DelWaterMark=function(t){if(".doc"!=this.FileType&&".docx"!=this.FileType)return!(this.Status="非Word文档，删除水印失败");if("-1"!=this.obj.ActiveDocument.ProtectionType)return!(this.Status="文档被锁定，删除水印失败");this.WebObject.ActiveDocument.ActiveWindow.ActivePane.View.SeekView=9;var e=this.WebObject.ActiveDocument.Application.Selection,i=e.HeaderFooter.Shapes.Count;if(0<i)for(var s=i;1<=s;s--)(e.HeaderFooter.Shapes.Item(s).Name=t+s)&&e.HeaderFooter.Shapes.Item(s).Delete();return this.WebObject.ActiveDocument.ActiveWindow.ActivePane.View.SeekView=0,this.Status="删除水印成功",!0},this.AddGraphicWaterMark=function(t){if(".doc"!=this.FileType&&".docx"!=this.FileType)return!(this.Status="非Word文档，插入水印失败");e=this.blnIE()?this.WebObject.ActiveDocument.Application.ActiveDocument.BuiltInDocumentProperties(14):this.WebObject.ActiveDocument.Application.ActiveDocument.BuiltInDocumentProperties.Item(14).Value();var e,i=parseInt(e),s=this.WebObject.ActiveDocument.Application.Selection;if("-1"!=this.obj.ActiveDocument.ProtectionType)return!(this.Status="文档被锁定，插入水印失败");for(var o=1;o<=i;o++){s.GoTo(1,1,o);try{this.WebObject.ActiveDocument.ActiveWindow.ActivePane.View.SeekView=9,this.WebObject.ActiveDocument.Application.Selection.ClearFormatting();var n=this.DownFilePath(),h="waterMaker.jpg",a=(this.DownloadToFile(h,n),s.HeaderFooter.Shapes.AddPicture(n+h,!1,!0).Select(),s.ShapeRange);a.Name=t+o,a.PictureFormat.Brightness=.85,a.PictureFormat.Contrast=.15,a.Rotation=315,a.Height=360,a.Width=360,a.WrapFormat.AllowOverlap=!0,a.WrapFormat.Side=3,a.WrapFormat.Type=3,a.RelativeHorizontalPosition=0,a.RelativeVerticalPosition=0,a.Left=-999995,a.Top=-999995,this.WebObject.ActiveDocument.ActiveWindow.ActivePane.View.SeekView=0,this.Status="水印添加成功"}catch(t){return this.Status="水印添加成功"+t.description,!1}}return!0},this.Close=function(){return 0==this.obj.Close()},this.ConsoleOut=function(t){this.DebugMode},this.WebPageSetup=function(){this.setShowDialog(this.ShowDialog.DialogPageSetup)},this.WebOpenPrint=function(){this.setShowDialog(this.ShowDialog.DialogPrint)},this.PrintPreview=function(){this.obj.PrintPreview()},this.PrintPreviewExit=function(){this.obj.PrintPreviewExit(),this.obj.ActiveDocument.ActiveWindow.View.ShowFieldCodes=!1},this.AppendTools=function(t,e,i){parseInt(t),this.obj.CustomToolbar.AddToolButton(t,e,i,e,0)},this.DisableTools=function(t,e){this.obj.CustomToolbar.DisableToolsButton(t,e),this.obj.Style.Invalidate()},this.VisibleTools=function(t,e){this.obj.CustomToolbar.VisibleToolsButton(t,e),this.obj.Style.Invalidate()},this.AppendMenu=function(t,e){var i=this.obj.CustomMenu;null==MenuFile&&(i.Clear(),MenuFile=i.CreatePopupMenu(),i.Add(MenuFile,"文件(&F)")),i.AppendMenu(MenuFile,t,!1,e),i.Update()},this.WebGetDocSuffix=function(){try{var t=this.getDocType(this.FileType),e=0;return t==this.DocType.WORD&&(this.Activate(!0),e=this.obj.ActiveDocument.SaveFormat),t==this.DocType.EXECL&&(this.obj.ExitExcelEditMode(),(e=this.obj.ActiveDocument.FileFormat)<0&&(e=56)),this.DocSuffixType[e]}catch(t){return this.FileType}},this.WebFullName=function(){return this.obj.FullName},this.InsertImageByBookMark=function(t,e){this.obj.ActiveDocument.BookMarks.Exists(this.BookMark)&&this.obj.ActiveDocument.Bookmarks.Item(this.BookMark).Select();var i=this.obj.ActiveDocument.Application.Selection.InlineShapes.AddPicture(this.DownloadedFileTempPathName),i=(i.Select(),i.ConvertToShape());return i.WrapFormat.Type=3,i.ZOrder(e),!0},this.DownloadToFile=function(t,e){var i=this.obj.Http,s=this.WebUrl.substring(0,this.WebUrl.lastIndexOf("/"));return i.ShowProgressUI=this.ShowWindow,i.Open(this.HttpMethod.Get,s+"/law/common/file/downloadWaterMarker/"+t,!1)&&i.Send()&&200==i.Status?(i.ResponseSaveToFile(e+t),i.Clear(),!0):(i.Close(),!1)},this.HandWriting=function(t,e){var i=this.obj.Handwritting,s=i.DrawingSetting;s.PenThicker=e,s.PenColor=t,i.AnnotateDraw(),this.ShowMenuBar(!1),this.ShowToolBars(!1)},this.StopHandWriting=function(){this.obj.Handwritting.StopAnnotate(),this.ShowMenuBar(!0),this.ShowToolBars(!0)},this.TextWriting=function(){var t=this.obj.Handwritting,e=t.TextSetting;e.TextSize=32,e.TextColor=12255487,e.FontName="宋体",t.AnnotateText(),this.ShowMenuBar(!1),this.ShowToolBars(!1)},this.ShapeWriting=function(){var t=this.obj.Handwritting,e=t.ShapeSetting;e.ShapeType=0,e.BackgroundColor=16777215,e.BorderColor=16711680,e.BorderWidth=6,t.AnnotateShape(),this.ShowMenuBar(!1),this.ShowToolBars(!1)},this.RemoveLastWriting=function(){this.obj.Handwritting.RemoveLast()},this.ShowWritingUser=function(bVal,username){var strxml=this.obj.GetAnnotations(),json=eval("("+strxml+")");if(""!=username&&null!=username&&null!=username)for(var i=0,id;i<json.Annotations.length;i++){json.Annotations[i].Annotation.User!=username&&(id=json.Annotations[i].Annotation.ID,this.obj.GetAnnotationByID(id).Visible=bVal)}else for(var i=0;i<json.Annotations.length;i++){var id=json.Annotations[i].Annotation.ID;this.obj.GetAnnotationByID(id).Visible=bVal}},this.GetDataToSend=function(){var httpclient=this.obj.Http,ReturnValue=(httpclient.Clear(),httpclient.GetResponseHeader("RName")),jsonObj=eval("("+ReturnValue+")"),i;for(i in jsonObj)this.WebSetMsgByName(i,jsonObj[i])},this.IWR=null,this.CreateRevision=function(){return null==this.obj?!(this.Status="iWebOffice2015对象未初始化"):null!=this.IWR?!(this.Status="手写组件对象已存在"):0!=this.obj.CreateNew("iWebRevision.iWebRevisionCtrl.1")?!(this.Status="创建手写组件对象失败"):(this.ShowTitleBar(!1),this.ShowMenuBar(!1),this.ShowStatusBar(!1),this.ShowCustomToolbar(!1),this.obj.Style.BorderStyle=0,this.IWR=this.obj.Application,!0)},this.OleDialogPrint=function(t,e){1==t?WebOffice.obj.ShowDialog(0):2==t?WebOffice.obj.ShowDialog(1,"Word Files(*.doc;*.docx;*.docm;*.dot;*.dotx;*.dotm;*.rtf)|*.doc;*.docx;*.docm;*.dot;*.dotx;*.dotm;*.rtf|Excel Files(*.xls;*.xlsx;*.xlsm;*.xlt;*.xltx;*.xltm)|*.xls;*.xlsx;*.xlsm;*.xlt;*.xltx;*.xltm|PowerPoint Files(*.ppt;*.pptx;*.pptm;*.pot;*.potx;*.potm)|*.ppt;*.pptx;*.pptm;*.pot;*.potx;*.potm|Project Files(*.mpp;*.mpt)|*.mpp;*.mpt|Visio Files(*.vsd;*.vdx;*.vss;*.vsx;*.vst;*.vtx;*.vsw;*.vdw;*.vsdx;*.vssx;*.vstx;*.vsdm;*.vssm;*.vstm)|*.vsd;*.vdx;*.vss;*.vsx;*.vst;*.vtx;*.vsw;*.vdw;*.vsdx;*.vssx;*.vstx;*.vsdm;*.vssm;*.vstm|All File(*.*)|*.*||",0):4==t?WebOffice.obj.ShowDialog(2):8==t?WebOffice.obj.ShowDialog(3):16==t?WebOffice.obj.ShowDialog(4):32==t?WebOffice.obj.ShowDialog(5):64==t?WebOffice.obj.ShowDialog(6):128==t&&WebOffice.obj.ActiveDocument.PrintPreview()}}}}]);