"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[5e3],{45e3:function(e,n,t){t.r(n),t.d(n,{default:function(){return i}});var o=new(t(54953).Z),n={name:"savePdf",data:function(){return{fullscreenLoading:!0,filePath:"",fileName:"",userName:"",fileType:"",resultList:[]}},props:{fileId:{default:""}},methods:{initEditOnline:function(){this.loadFileInfo()},loadFileInfo:function(){var n=this,e="/law/common/file/loadFileInfo/"+(this.$route.params.fileId||this.fileId);this.$ajax({url:e,method:"post"}).then(function(e){n.filePath=e.data.data.FILEPATH,n.fileName=e.data.data.FILENAME,n.userName=e.data.data.USERNAME,n.fileType=e.data.data.FILETYPE,n.loadWebOffice()}).catch(function(){n.$emit("hidePdf")})},StatusMsg:function(e){try{document.getElementById("StatusBar").innerHtml=e}catch(e){return!1}},SaveDocument:function(){try{var e=document.getElementById("WebOffice"),n=("PDF(*.pdf)|*.pdf;"+"|PDF文档(*.pdf)|*.pdf"+"||",this.fileName.substring(0,this.fileName.lastIndexOf("."))),t=e.FileSystem.FileSaveAs("PDF(*.pdf)|*.pdf;|PDF文档(*.pdf)|*.pdf||",n+".pdf");t&&o.SaveAsPdf(t)}catch(e){this.$alert(this.$t("文件导出失败"))}this.fullscreenLoading=!1,this.$emit("hidePdf")},loadWebOffice:function(){o.WebUrl=this.httpCode+"/law/OfficeServer",o.Compatible=!1,o.FileType=this.fileType,o.DebugMode=!1,o.ShowWindow=!0,o.ShowType="1",o.EditType="2",o.ShowMenu="0",o.ShowToolBar="0",o.WebSetMsgByName("GETFILEPATH",this.filePath),o.WebSetMsgByName("GETFILENAME",this.fileName),o.WebSetMsgByName("ISCLEARSAVE",1),o.FileName=this.fileName,o.UserName=this.userName,!o.WebOpen()||".doc"!=this.fileType&&".docx"!=this.fileType||(o.ClearRevisions(),o.WebSetMsgByName("GETFILEPATH",this.filePath),o.WebSetMsgByName("GETFILENAME",this.fileName),o.FileName=this.fileName,o.FileType=this.fileType,o.FilePath=this.filePath,o.WebSave(),this.StatusMsg(o.Status)),this.SaveDocument()}},created:function(){},mounted:function(){var e,n,t,i,a,l,d;n=navigator.userAgent,t=/(msie\s|trident.*rv:)([\w.]+)/,i=/(firefox)\/([\w.]+)/,a=/(opera).+version\/([\w.]+)/,l=/(chrome)\/([\w.]+)/,d=/version\/([\w.]+).*(safari)/,n.toLowerCase(),n=n.toLowerCase(),(i=null!=(t=t.exec(n))?{browser:"IE",version:t[2]||"0"}:null!=(t=i.exec(n))||null!=(t=a.exec(n))||null!=(t=l.exec(n))?{browser:t[1]||"",version:t[2]||"0"}:null!=(t=d.exec(n))?{browser:t[2]||"",version:t[1]||"0"}:void 0).browser&&(e=i.browser,i.version),a="",l="正中投资集团[专用];V5.0S0xGAAEAAAAAAAAAEAAAAGUBAABwAQAALAAAAEVCO5SZLwYA6DvA2scF68M4CQGw1tMqjNhGnoyiny/DFmTMg8kMCwmZsOV2KkD4YhETSXcZUXl/U6mS3Urn23/9GHwM3uHhjK13+ZbAeZZOXOyK03Je2GO3b/8qdGQYKXeTdx9PbiCehY2acIETeXkGIa2DV7tHazqYq+Vrc9RtvSMLdPkzUlkz3W8ty6ZVe/kHA+gdEeutYeOjhPxtqcQGJngnMsMy9D0Lbeu3o3sM1X/r008Cd7+NUORJCqClPLzIL/aS6cSgHBnWUuTO4ewGG06rkzoQPx/wUQgXw5+BNlSEaxTm0Xsp2TKMCTuCU++VAv/bCGPlmLjl4Y4Dan8l9s9uldieav39IqMhelNBgUWn5tlQibZvxXyei0xkP8ze+s5ejutU1eqzBuUTFJTw58BTWZDRNr6hMYAPR9PuKu5evQ5NQL+sS+7Ed64J/lZXLt6qTDfoxqELRHLPIOBqH7280bsKzu1TN5VHRRzPTxA/foYL8D/f1NafC7kwkA==",a+='<object id="WebOffice"  width="100%" height="100%"',null!=window.ActiveXObject||null!=window.ActiveXObject||"ActiveXObject"in window?("Win32"==window.navigator.platform&&(a+=' CLASSID="CLSID:D89F482C-5045-4DB5-8C53-D2C9EE71D025"  codebase="iWebOffice2015.cab#version=0,0,0,0"'),"Win64"==window.navigator.platform&&(a+=' CLASSID="CLSID:D89F482C-5045-4DB5-8C53-D2C9EE71D024"  codebase="iWebOffice2015.cab#version=0,0,0,0"'),a=a+'><param name="Copyright" value="'+l+'">'):"chrome"==e?a=(a+=' clsid="CLSID:D89F482C-5045-4DB5-8C53-D2C9EE71D025" type="application/kg-plugin" OnCommand="OnCommand" OnRightClickedWhenAnnotate="OnRightClickedWhenAnnotate" OnSending="OnSending" OnSendEnd="OnSendEnd" OnRecvStart="OnRecvStart" OnRecving="OnRecving" OnRecvEnd="OnRecvEnd" OnFullSizeBefore="OnFullSizeBefore" OnFullSizeAfter="OnFullSizeAfter"')+' Copyright="'+l+'">':"firefox"==e&&(a=(a+=' clsid="CLSID:D89F482C-5045-4DB5-8C53-D2C9EE71D025" type="application/kg-activex" OnCommand="OnCommand" OnReady="OnReady" OnOLECommand="OnOLECommand" OnExecuteScripted="OnExecuteScripted" OnQuit="OnQuit" OnSendStart="OnSendStart" OnSending="OnSending" OnSendEnd="OnSendEnd" OnRecvStart="OnRecvStart" OnRecving="OnRecving" OnRecvEnd="OnRecvEnd" OnRightClickedWhenAnnotate="OnRightClickedWhenAnnotate" OnFullSizeBefore="OnFullSizeBefore" OnFullSizeAfter="OnFullSizeAfter"')+' Copyright="'+l+'">'),a+="</object>",document.getElementById("WebOffice2015")&&(document.getElementById("WebOffice2015").innerHTML=a),o.setObj(document.getElementById("WebOffice")),this.initEditOnline(),document.getElementById("WebOffice2015").style.display="block"}},i=(0,t(1001).Z)(n,function(){var e=this,n=e.$createElement,n=e._self._c||n;return n("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.fullscreenLoading,expression:"fullscreenLoading",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"pdfModal"},[n("span",[e._v(" "+e._s(e.$t("正在将文档转换为pdf，请您耐心等待..."))+" ")]),e._m(0)])},[function(){var e=this.$createElement,e=this._self._c||e;return e("div",{staticStyle:{width:"1px",height:"1px"}},[e("div",{attrs:{id:"WebOffice2015"}})])}],!1,null,"4e852133",null).exports}}]);